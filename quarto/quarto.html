<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Heli Xu">

<title>ADGRs in lymphatic endothelial cells in scRNA-seq datasets</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="quarto_files/libs/clipboard/clipboard.min.js"></script>
<script src="quarto_files/libs/quarto-html/quarto.js"></script>
<script src="quarto_files/libs/quarto-html/popper.min.js"></script>
<script src="quarto_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="quarto_files/libs/quarto-html/anchor.min.js"></script>
<link href="quarto_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="quarto_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="quarto_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="quarto_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="quarto_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ADGRs in lymphatic endothelial cells in scRNA-seq datasets</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Heli Xu </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<div class="cell" data-hash="quarto_cache/html/unnamed-chunk-1_cd26515728885684f3c079fe2298ddda">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Seurat)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="dataset1-postmi-mice-heart" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="dataset1-postmi-mice-heart">Dataset1: postMI mice heart</h2>
<p><a href="https://elifesciences.org/articles/43882">Publication source</a></p>
<section id="identification-of-lec" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="identification-of-lec">Identification of LEC</h3>
<p>The paper did not include cell type information in the dataset, so we will use established markers to define endothelial cells (EC) and lymphatic endothelial cells (LEC).</p>
<p>EC markers used include: Pecam1, Icam2, Cdh5 (code or image to be added)</p>
<div class="cell" data-hash="quarto_cache/html/unnamed-chunk-2_30b90b3544490a24c4b3ef2d70f74a4f">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dependencies </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Based on the plot, we’ll define cluster 2, 7, 9, 12, 15, 18, 19 as EC.</p>
<p>Among them, we’ll use LEC lineage markers to identify possible LEC populations. Markers used include: Pdpn, Flt4, Prox1, Ackr4, Msr1, Fcgr2b, Lyve1, Fth1</p>
<div class="cell" data-hash="quarto_cache/html/unnamed-chunk-3_9edda0e9620c2d1f82153653afb3145a">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"../data/healthy MI non myocyte cardiac/clean/MI_EC_orig_ident.rdata"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">##this is EC subset without changing idents to "sample"!</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(TIP_MI_EC, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"Pdpn"</span>,<span class="st">"Flt4"</span>,<span class="st">"Prox1"</span>,<span class="st">"Ackr4"</span>,<span class="st">"Msr1"</span>,<span class="st">"Fcgr2b"</span>, </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Lyve1"</span>, <span class="st">"Fth1"</span>),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">pt.size =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="quarto_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DotPlot</span>(TIP_MI_EC,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"Pdpn"</span>,<span class="st">"Flt4"</span>,<span class="st">"Prox1"</span>,<span class="st">"Ackr4"</span>,<span class="st">"Msr1"</span>,<span class="st">"Fcgr2b"</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Lyve1"</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.min =</span> <span class="dv">0</span>, <span class="at">col.max =</span> <span class="dv">3</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">dot.min =</span> <span class="dv">0</span>, <span class="at">dot.scale =</span> <span class="dv">6</span>)<span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="quarto_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>*note that Fth1 is not shown in the dot plot to visualize the less expressed markers.</p>
<p>It looks like the cluster 9 and 15 are likely to be LEC. Firstly, we’ll plot all the ADGRs (33 in total) in EC to put it in perspective. (When all cells show same value of expression for a gene, it usually means the gene is minimally expressed, and therefore with scaling the values become quite indistinguishable. )</p>
<div class="cell page-columns page-full" data-hash="quarto_cache/html/unnamed-chunk-4_ea61b53b444fa96c1fe1237b16182484">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ADGR_list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Adgra1"</span>, <span class="st">"Adgra2"</span>,<span class="st">"Adgra3"</span>, <span class="st">"Adgrb1"</span>,<span class="st">"Adgrb2"</span>, <span class="st">"Adgrb3"</span>, <span class="st">"Adgrc3"</span>,<span class="st">"Adgrc1"</span>, <span class="st">"Adgrc2"</span>, <span class="st">"Adgrd1"</span>, <span class="st">"Adgrd2"</span>, <span class="st">"Adgre1"</span>, <span class="st">"Adgre2"</span>, <span class="st">"Adgre3"</span>, <span class="st">"Adgre4"</span>, <span class="st">"Adgre5"</span>, <span class="st">"Adgrf1"</span>, <span class="st">"Adgrf2"</span>, <span class="st">"Adgrf3"</span>, <span class="st">"Adgrf4"</span>,<span class="st">"Adgrf5"</span>,<span class="st">"Adgrg1"</span>,<span class="st">"Adgrg2"</span>,<span class="st">"Adgrg3"</span>, <span class="st">"Adgrg4"</span>, <span class="st">"Adgrg5"</span>, <span class="st">"Adgrg6"</span>, <span class="st">"Adgrg7"</span>,<span class="st">"Adgrl1"</span>, <span class="st">"Adgrl2"</span>, <span class="st">"Adgrl3"</span>, <span class="st">"Adgrl4"</span>, <span class="st">"Adgrv1"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">FeaturePlot</span>(TIP_MI_EC, </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">reduction =</span> <span class="st">"tsne"</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">features=</span> ADGR_list,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">sort.cell =</span> <span class="cn">TRUE</span>, </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">min.cutoff =</span> <span class="st">'q10'</span>, </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">label =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-page">
<p><img src="quarto_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<p>Other than the 11 undetectable ADGRs, several ADGRs show very low expression level (in few cells) in the plot above. We’ll narrow the list down (Adgra2, Adgra3, Adgrb1, Adgre1, Adgre5, Adgrf5, Adgrg1, Adgrg3, Adgrl1, Adgrl2, Adgrl4) and look further below.</p>
<div class="cell" data-hash="quarto_cache/html/unnamed-chunk-5_ce65383e5925e4e859ff37d5eb315e79">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(TIP_MI_EC,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">features=</span> <span class="fu">c</span>(<span class="st">"Adgra2"</span>, <span class="st">"Adgra3"</span>, <span class="st">"Adgrb1"</span>, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Adgre1"</span>, <span class="st">"Adgre5"</span>, <span class="st">"Adgrf5"</span>, </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Adgrg1"</span>, <span class="st">"Adgrg3"</span>,<span class="st">"Adgrl1"</span>, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Adgrl2"</span>, <span class="st">"Adgrl4"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="quarto_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Adgrb1 barely shows up in the violin plot and could be excluded from further examination, but we are keeping it for its (very low) expression in cluster 15 (LEC).</p>
</section>
<section id="adgrs-expression-in-lec-sham-vs-mi" class="level3">
<h3 class="anchored" data-anchor-id="adgrs-expression-in-lec-sham-vs-mi">ADGRs expression in LEC (sham vs MI)</h3>
<p>Now we can zoom in to the LEC clusters and look at the ADGRs expression profile among different conditions.</p>
<div class="cell" data-hash="quarto_cache/html/unnamed-chunk-6_0bf4c13327e25599b77f50dca79d66a2">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"../data/healthy MI non myocyte cardiac/clean/MI_LEC_normalized.rdata"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">DotPlot</span>(TIP_MI_LEC,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"Adgra2"</span>, <span class="st">"Adgra3"</span>,  </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Adgre1"</span>, <span class="st">"Adgre5"</span>, <span class="st">"Adgrf5"</span>, </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Adgrg1"</span>, <span class="st">"Adgrg3"</span>, <span class="st">"Adgrl1"</span>, </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Adgrl2"</span>, <span class="st">"Adgrl4"</span>),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.min =</span> <span class="dv">0</span>, <span class="at">col.max =</span> <span class="dv">3</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">dot.min =</span> <span class="dv">0</span>, <span class="at">dot.scale =</span> <span class="dv">6</span>)<span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="quarto_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="quarto_cache/html/unnamed-chunk-7_64950240a4f271197915b9c765a11083">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(TIP_MI_LEC, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"Adgra2"</span>, <span class="st">"Adgra3"</span>,  </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Adgre1"</span>, <span class="st">"Adgre5"</span>, <span class="st">"Adgrf5"</span>, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Adgrg1"</span>, <span class="st">"Adgrg3"</span>, <span class="st">"Adgrl1"</span>, </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Adgrl2"</span>, <span class="st">"Adgrl4"</span>),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">pt.size=</span><span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="quarto_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Taking one step further, we are now looking at the individual LEC cluster separately (note the legend order is different):</p>
<div class="cell" data-hash="quarto_cache/html/unnamed-chunk-8_dc5d77827f1dca5dad5b5b61e556a719">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(TIP_MI_EC, <span class="at">features =</span><span class="fu">c</span>(<span class="st">"Adgra2"</span>, <span class="st">"Adgra3"</span>,<span class="st">"Adgrb1"</span>, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Adgre1"</span>, <span class="st">"Adgre5"</span>, <span class="st">"Adgrf5"</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Adgrg1"</span>, <span class="st">"Adgrg3"</span>, <span class="st">"Adgrl1"</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Adgrl2"</span>, <span class="st">"Adgrl4"</span>),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">idents =</span> <span class="dv">9</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">group.by =</span> <span class="st">"sample"</span>, <span class="co">#split.by doesn't show legend with multiple features</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">pt.size=</span><span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="quarto_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="cell" data-hash="quarto_cache/html/unnamed-chunk-9_e9603776a430b74cec22ce26891a4beb">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(TIP_MI_EC, <span class="at">features =</span><span class="fu">c</span>(<span class="st">"Adgra2"</span>, <span class="st">"Adgra3"</span>,<span class="st">"Adgrb1"</span>, </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Adgre1"</span>, <span class="st">"Adgre5"</span>, <span class="st">"Adgrf5"</span>, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Adgrg1"</span>, <span class="st">"Adgrg3"</span>, <span class="st">"Adgrl1"</span>, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">"Adgrl2"</span>, <span class="st">"Adgrl4"</span>),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">idents =</span> <span class="dv">15</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">group.by =</span> <span class="st">"sample"</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">pt.size=</span><span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="quarto_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>##Dataset2: postTAC mouse heart</p>
<p><a href="https://www.ahajournals.org/doi/10.1161/CIRCULATIONAHA.119.043053?url_ver=Z39.88-2003&amp;rfr_id=ori:rid:crossref.org&amp;rfr_dat=cr_pub%20%200pubmed">Publication source</a></p>
<p>###Identification of LEC clusters</p>
<p>This dataset contains cell type information, which includes 9 clusters of EC. Here we will use the same LEC markers as before to identify the possible LEC clusters among them.</p>
<div class="cell" data-hash="quarto_cache/html/unnamed-chunk-10_99794bd688bb2b3b1a3d542b69f24355">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"../data/GSE120064_TAC CM_NMCC_mtx_cell_info/clean/TAC_EC_umap.rdata"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(EC, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"Pdpn"</span>,<span class="st">"Flt4"</span>,<span class="st">"Prox1"</span>,<span class="st">"Ackr4"</span>,<span class="st">"Msr1"</span>,<span class="st">"Fcgr2b"</span>, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"Lyve1"</span>, <span class="st">"Fth1"</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">pt.size =</span> <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="quarto_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We will include cluster 2, 3 and 8 as LEC and examine the ADGRs in them.</p>
</section>
<section id="adgrs-expression-in-lec" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="adgrs-expression-in-lec">ADGRs expression in LEC</h3>
<p>Again, we’ll plot ADGRs in all EC clusters to keep things in perspective.</p>
<div class="cell page-columns page-full" data-hash="quarto_cache/html/unnamed-chunk-11_1872c1e04aeefb03e2926d5a2570d14d">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ADGR_list_oldname <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Gpr123"</span>, <span class="st">"Gpr124"</span>, <span class="st">"Gpr125"</span>, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Bai1"</span>, <span class="st">"Bai2"</span>, <span class="st">"Bai3"</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Cselr1"</span>, <span class="st">"Cselr2"</span>, <span class="st">"Cselr3"</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Gpr133"</span>, <span class="st">"Gpr144"</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Emr1"</span>, <span class="st">"Emr2"</span>, <span class="st">"Emr3"</span>, <span class="st">"Emr4"</span>, <span class="st">"Cd97"</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">'Gpr110'</span>, <span class="st">"Gpr111"</span>, <span class="st">"Gpr113"</span>, <span class="st">"Gpr115"</span>, <span class="st">"Gpr116"</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Gpr56"</span>, <span class="st">"Gpr64"</span>, <span class="st">"Gpr97"</span>, <span class="st">"Gpr112"</span>, <span class="st">"Gpr114"</span>, <span class="st">'Gpr126'</span>, <span class="st">"Gpr128"</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">'Lphn1'</span>, <span class="st">'Lphn2'</span>, <span class="st">'Lphn3'</span>, <span class="st">"Eltd1"</span>, <span class="st">"Vlgr1"</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">FeaturePlot</span>(EC, </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">reduction =</span> <span class="st">"umap"</span>, </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">features=</span> ADGR_list_oldname,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">sort.cell =</span> <span class="cn">TRUE</span>, </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">min.cutoff =</span> <span class="st">'q10'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-page">
<p><img src="quarto_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<p>The undetectable ADGRs are left out from the plot above. Sub-clusters labels are not shown for better visualization of the expression levels. For the ones with relatively higher expression (Gpr124, GPr125, Emr1, Cd97, Gpr116, Gpr56, Lphn1, Lphn2 and Eltd1), we’ll include them for further examination. For the other ones with sporadic expression, we will use violin plot to check the expression levels in different subclusters more directly.</p>
<div class="cell page-columns page-full" data-hash="quarto_cache/html/unnamed-chunk-12_bc66ed48431174ae313919e971052d6b">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(EC, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"Gpr123"</span>, <span class="st">"Bai1"</span>, <span class="st">"Bai2"</span>,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Bai3"</span>, <span class="st">"Gpr133"</span>, <span class="st">"Emr4"</span>, <span class="st">"Gpr110"</span>,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                         <span class="st">"Gpr111"</span>, <span class="st">"Gpr113"</span>, <span class="st">"Gpr115"</span>, <span class="st">"Gpr64"</span>, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                         <span class="st">'Gpr97'</span>, <span class="st">'Gpr112'</span>, <span class="st">'Gpr114'</span>, <span class="st">"Gpr126"</span>, <span class="st">"Gpr128"</span>, <span class="st">'Lphn3'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display column-page">
<p><img src="quarto_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<p>We’ll include those with &gt;0.5 relative expression levels (arbitrary) in LEC clusters: Gpr113, Gpr97, Gpr126, Lphn3.</p>
<p>After narrowing down the list, we can now visualize expression levels of these ADGRs in different conditions.</p>
<div class="cell" data-hash="quarto_cache/html/unnamed-chunk-13_abcf2fe4fc0db35154bdc6d3e8f5e0e1">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"../data/GSE120064_TAC CM_NMCC_mtx_cell_info/clean/TAC_LEC_metadata.rdata"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">DotPlot</span>(TAC_LEC,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"Emr1"</span>,  <span class="st">"Cd97"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Gpr113"</span>,  <span class="st">"Gpr116"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Gpr56"</span>, <span class="st">"Gpr97"</span>,  <span class="st">'Gpr126'</span>, </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Lphn1'</span>, <span class="st">'Lphn2'</span>, <span class="st">'Lphn3'</span>, <span class="st">"Eltd1"</span>),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.min =</span> <span class="dv">0</span>, <span class="at">col.max =</span> <span class="dv">3</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">dot.min =</span> <span class="dv">0</span>, <span class="at">dot.scale =</span> <span class="dv">6</span>)<span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="quarto_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="quarto_cache/html/unnamed-chunk-14_b87fcd5f1bc43b0078bffb404088123d">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(TAC_LEC, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"Emr1"</span>,  <span class="st">"Cd97"</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Gpr113"</span>,  <span class="st">"Gpr116"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Gpr56"</span>, <span class="st">"Gpr97"</span>,  <span class="st">'Gpr126'</span>, </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Lphn1'</span>, <span class="st">'Lphn2'</span>, <span class="st">'Lphn3'</span>, <span class="st">"Eltd1"</span>),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">pt.size=</span><span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="quarto_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Lastly, we’ll look at individual LEC cluster to explore possible pattern.</p>
<div class="cell" data-hash="quarto_cache/html/unnamed-chunk-15_5065729af248b1c9c6aa1a1179947ce9">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>metadata_lec <span class="ot">&lt;-</span> TAC_LEC<span class="sc">@</span>meta.data</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Idents</span>(TAC_LEC) <span class="ot">&lt;-</span> metadata_lec<span class="sc">$</span>SubCluster</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(TAC_LEC,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"Emr1"</span>,  <span class="st">"Cd97"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Gpr113"</span>,  <span class="st">"Gpr116"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Gpr56"</span>, <span class="st">"Gpr97"</span>,  <span class="st">'Gpr126'</span>, </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Lphn1'</span>, <span class="st">'Lphn2'</span>, <span class="st">'Lphn3'</span>, <span class="st">"Eltd1"</span>),</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">idents =</span> <span class="st">"EC2"</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">group.by =</span> <span class="st">"condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="quarto_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="cell" data-hash="quarto_cache/html/unnamed-chunk-16_fd2890eb9aea90b5b96305cceb8ae32e">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(TAC_LEC,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"Emr1"</span>,  <span class="st">"Cd97"</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Gpr113"</span>,  <span class="st">"Gpr116"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Gpr56"</span>, <span class="st">"Gpr97"</span>,  <span class="st">'Gpr126'</span>, </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Lphn1'</span>, <span class="st">'Lphn2'</span>, <span class="st">'Lphn3'</span>, <span class="st">"Eltd1"</span>),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">idents =</span> <span class="st">"EC3"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">group.by =</span> <span class="st">"condition"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="quarto_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Interestingly, both EC2 and EC3 show detectable expression only at baseline (0w) for the ADGRs examined, while EC8 cells express several ADGRs in all 5 different conditions.</p>
<div class="cell" data-hash="quarto_cache/html/unnamed-chunk-17_b8ad966d1633d5dedf9cb60990a6499f">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"../data/GSE120064_TAC CM_NMCC_mtx_cell_info/clean/TAC_LEC_cluster8_condition.rdata"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(TAC_LEC8,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"Emr1"</span>,  <span class="st">"Cd97"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Gpr113"</span>,  <span class="st">"Gpr116"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Gpr56"</span>, <span class="st">"Gpr97"</span>,  <span class="st">'Gpr126'</span>, </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">'Lphn1'</span>, <span class="st">'Lphn2'</span>, <span class="st">'Lphn3'</span>, <span class="st">"Eltd1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="quarto_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="768"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>