{
  "hash": "f33e9380d5d9e66ee2dbd2064e8e73f3",
  "result": {
    "markdown": "---\ntitle: \"ADGRs in lymphatic endothelial cells in scRNA-seq datasets\"\nauthor: \"Heli Xu\"\nformat: html\neditor: visual\nexecute: \n  warning: false\n  error: false\n  cache: true\n---\n\n::: {.cell hash='quarto_cache/html/unnamed-chunk-1_cd26515728885684f3c079fe2298ddda'}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(Seurat)\nlibrary(ggplot2)\n```\n:::\n\n\n## Dataset1: postMI mice heart\n\n[Publication source](https://elifesciences.org/articles/43882)\n\n### Identification of LEC\n\nThe paper did not include cell type information in the dataset, so we will use established markers to define endothelial cells (EC) and lymphatic endothelial cells (LEC).\n\nEC markers used include: Pecam1, Icam2, Cdh5 (code or image to be added)\n\n\n::: {.cell hash='quarto_cache/html/unnamed-chunk-2_30b90b3544490a24c4b3ef2d70f74a4f'}\n\n```{.r .cell-code}\n#dependencies \n```\n:::\n\n\nBased on the plot, we'll define cluster 2, 7, 9, 12, 15, 18, 19 as EC.\n\nAmong them, we'll use LEC lineage markers to identify possible LEC populations. Markers used include: Pdpn, Flt4, Prox1, Ackr4, Msr1, Fcgr2b, Lyve1, Fth1\n\n\n::: {.cell hash='quarto_cache/html/unnamed-chunk-3_9edda0e9620c2d1f82153653afb3145a'}\n\n```{.r .cell-code}\nload(\"../data/healthy MI non myocyte cardiac/clean/MI_EC_orig_ident.rdata\")\n##this is EC subset without changing idents to \"sample\"!\n\nVlnPlot(TIP_MI_EC, \n        features = c(\"Pdpn\",\"Flt4\",\"Prox1\",\"Ackr4\",\"Msr1\",\"Fcgr2b\", \n                     \"Lyve1\", \"Fth1\"),\n        pt.size = 0.1)\n```\n\n::: {.cell-output-display}\n![](quarto_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nDotPlot(TIP_MI_EC,\n        features = c(\"Pdpn\",\"Flt4\",\"Prox1\",\"Ackr4\",\"Msr1\",\"Fcgr2b\", \n                     \"Lyve1\"),\n        col.min = 0, col.max = 3,\n        dot.min = 0, dot.scale = 6)+\n  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))\n```\n\n::: {.cell-output-display}\n![](quarto_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\n\n\\*note that Fth1 is not shown in the dot plot to visualize the less expressed markers.\n\nIt looks like the cluster 9 and 15 are likely to be LEC. Firstly, we'll plot all the ADGRs (33 in total) in EC to put it in perspective. (When all cells show same value of expression for a gene, it usually means the gene is minimally expressed, and therefore with scaling the values become quite indistinguishable. )\n\n\n::: {.cell .column-page hash='quarto_cache/html/unnamed-chunk-4_ea61b53b444fa96c1fe1237b16182484'}\n\n```{.r .cell-code}\nADGR_list <- c(\"Adgra1\", \"Adgra2\",\"Adgra3\", \"Adgrb1\",\"Adgrb2\", \"Adgrb3\", \"Adgrc3\",\"Adgrc1\", \"Adgrc2\", \"Adgrd1\", \"Adgrd2\", \"Adgre1\", \"Adgre2\", \"Adgre3\", \"Adgre4\", \"Adgre5\", \"Adgrf1\", \"Adgrf2\", \"Adgrf3\", \"Adgrf4\",\"Adgrf5\",\"Adgrg1\",\"Adgrg2\",\"Adgrg3\", \"Adgrg4\", \"Adgrg5\", \"Adgrg6\", \"Adgrg7\",\"Adgrl1\", \"Adgrl2\", \"Adgrl3\", \"Adgrl4\", \"Adgrv1\")\n\nFeaturePlot(TIP_MI_EC, \n            reduction = \"tsne\", \n            features= ADGR_list,\n            sort.cell = TRUE, \n            min.cutoff = 'q10', \n            label = TRUE) \n```\n\n::: {.cell-output-display}\n![](quarto_files/figure-html/unnamed-chunk-4-1.png){width=864}\n:::\n:::\n\n\nOther than the 11 undetectable ADGRs, several ADGRs show very low expression level (in few cells) in the plot above. We'll narrow the list down (Adgra2, Adgra3, Adgrb1, Adgre1, Adgre5, Adgrf5, Adgrg1, Adgrg3, Adgrl1, Adgrl2, Adgrl4) and look further below.\n\n\n::: {.cell hash='quarto_cache/html/unnamed-chunk-5_ce65383e5925e4e859ff37d5eb315e79'}\n\n```{.r .cell-code}\nVlnPlot(TIP_MI_EC,\n        features= c(\"Adgra2\", \"Adgra3\", \"Adgrb1\", \n                    \"Adgre1\", \"Adgre5\", \"Adgrf5\", \n                    \"Adgrg1\", \"Adgrg3\",\"Adgrl1\", \n                    \"Adgrl2\", \"Adgrl4\"))\n```\n\n::: {.cell-output-display}\n![](quarto_files/figure-html/unnamed-chunk-5-1.png){width=768}\n:::\n:::\n\n\nAdgrb1 barely shows up in the violin plot and could be excluded from further examination, but we are keeping it for its (very low) expression in cluster 15 (LEC).\n\n### ADGRs expression in LEC (sham vs MI)\n\nNow we can zoom in to the LEC clusters and look at the ADGRs expression profile among different conditions.\n\n\n::: {.cell hash='quarto_cache/html/unnamed-chunk-6_0bf4c13327e25599b77f50dca79d66a2'}\n\n```{.r .cell-code}\nload(\"../data/healthy MI non myocyte cardiac/clean/MI_LEC_normalized.rdata\")\n\nDotPlot(TIP_MI_LEC,\n        features = c(\"Adgra2\", \"Adgra3\",  \n                       \"Adgre1\", \"Adgre5\", \"Adgrf5\", \n                       \"Adgrg1\", \"Adgrg3\", \"Adgrl1\", \n                       \"Adgrl2\", \"Adgrl4\"),\n        col.min = 0, col.max = 3,\n        dot.min = 0, dot.scale = 6)+\n  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))\n```\n\n::: {.cell-output-display}\n![](quarto_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='quarto_cache/html/unnamed-chunk-7_64950240a4f271197915b9c765a11083'}\n\n```{.r .cell-code}\nVlnPlot(TIP_MI_LEC, \n        features = c(\"Adgra2\", \"Adgra3\",  \n                     \"Adgre1\", \"Adgre5\", \"Adgrf5\", \n                     \"Adgrg1\", \"Adgrg3\", \"Adgrl1\", \n                     \"Adgrl2\", \"Adgrl4\"),\n        pt.size=0.1)\n```\n\n::: {.cell-output-display}\n![](quarto_files/figure-html/unnamed-chunk-7-1.png){width=768}\n:::\n:::\n\n\nTaking one step further, we are now looking at the individual LEC cluster separately (note the legend order is different):\n\n\n::: {.cell hash='quarto_cache/html/unnamed-chunk-8_dc5d77827f1dca5dad5b5b61e556a719'}\n\n```{.r .cell-code}\nVlnPlot(TIP_MI_EC, features =c(\"Adgra2\", \"Adgra3\",\"Adgrb1\", \n                                \"Adgre1\", \"Adgre5\", \"Adgrf5\", \n                                \"Adgrg1\", \"Adgrg3\", \"Adgrl1\", \n                                \"Adgrl2\", \"Adgrl4\"),\n        idents = 9,\n        group.by = \"sample\", #split.by doesn't show legend with multiple features\n        pt.size=0.1)\n```\n\n::: {.cell-output-display}\n![](quarto_files/figure-html/unnamed-chunk-8-1.png){width=768}\n:::\n:::\n\n::: {.cell hash='quarto_cache/html/unnamed-chunk-9_e9603776a430b74cec22ce26891a4beb'}\n\n```{.r .cell-code}\nVlnPlot(TIP_MI_EC, features =c(\"Adgra2\", \"Adgra3\",\"Adgrb1\", \n                                 \"Adgre1\", \"Adgre5\", \"Adgrf5\", \n                                 \"Adgrg1\", \"Adgrg3\", \"Adgrl1\", \n                                 \"Adgrl2\", \"Adgrl4\"),\n        idents = 15,\n        group.by = \"sample\",\n        pt.size=0.1)\n```\n\n::: {.cell-output-display}\n![](quarto_files/figure-html/unnamed-chunk-9-1.png){width=768}\n:::\n:::\n\n\n##Dataset2: postTAC mouse heart\n\n[Publication source](https://www.ahajournals.org/doi/10.1161/CIRCULATIONAHA.119.043053?url_ver=Z39.88-2003&rfr_id=ori:rid:crossref.org&rfr_dat=cr_pub%20%200pubmed)\n\n###Identification of LEC clusters\n\nThis dataset contains cell type information, which includes 9 clusters of EC. Here we will use the same LEC markers as before to identify the possible LEC clusters among them.\n\n\n::: {.cell hash='quarto_cache/html/unnamed-chunk-10_99794bd688bb2b3b1a3d542b69f24355'}\n\n```{.r .cell-code}\nload(\"../data/GSE120064_TAC CM_NMCC_mtx_cell_info/clean/TAC_EC_umap.rdata\")\n\nVlnPlot(EC, features = c(\"Pdpn\",\"Flt4\",\"Prox1\",\"Ackr4\",\"Msr1\",\"Fcgr2b\", \n                                  \"Lyve1\", \"Fth1\"),\n        pt.size = 0.1)\n```\n\n::: {.cell-output-display}\n![](quarto_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nWe will include cluster 2, 3 and 8 as LEC and examine the ADGRs in them.\n\n### ADGRs expression in LEC \n\nAgain, we'll plot ADGRs in all EC clusters to keep things in perspective.\n\n\n::: {.cell .column-page hash='quarto_cache/html/unnamed-chunk-11_1872c1e04aeefb03e2926d5a2570d14d'}\n\n```{.r .cell-code}\nADGR_list_oldname <- c(\"Gpr123\", \"Gpr124\", \"Gpr125\", \n                       \"Bai1\", \"Bai2\", \"Bai3\",\n                       \"Cselr1\", \"Cselr2\", \"Cselr3\",\n                       \"Gpr133\", \"Gpr144\",\n                       \"Emr1\", \"Emr2\", \"Emr3\", \"Emr4\", \"Cd97\",\n                       'Gpr110', \"Gpr111\", \"Gpr113\", \"Gpr115\", \"Gpr116\",\n                       \"Gpr56\", \"Gpr64\", \"Gpr97\", \"Gpr112\", \"Gpr114\", 'Gpr126', \"Gpr128\",\n                       'Lphn1', 'Lphn2', 'Lphn3', \"Eltd1\", \"Vlgr1\")\n\nFeaturePlot(EC, \n            reduction = \"umap\", \n            features= ADGR_list_oldname,\n            sort.cell = TRUE, \n            min.cutoff = 'q10') \n```\n\n::: {.cell-output-display}\n![](quarto_files/figure-html/unnamed-chunk-11-1.png){width=864}\n:::\n:::\n\n\nThe undetectable ADGRs are left out from the plot above. Sub-clusters labels are not shown for better visualization of the expression levels. \nFor the ones with relatively higher expression (Gpr124, GPr125, Emr1, Cd97, Gpr116, Gpr56, Lphn1, Lphn2 and Eltd1), we'll include them for further examination. For the other ones with sporadic expression, we will use violin plot to check the expression levels in different subclusters more directly.\n\n\n\n::: {.cell .column-page hash='quarto_cache/html/unnamed-chunk-12_bc66ed48431174ae313919e971052d6b'}\n\n```{.r .cell-code}\nVlnPlot(EC, features = c(\"Gpr123\", \"Bai1\", \"Bai2\",\n                         \"Bai3\", \"Gpr133\", \"Emr4\", \"Gpr110\",\n                         \"Gpr111\", \"Gpr113\", \"Gpr115\", \"Gpr64\", \n                         'Gpr97', 'Gpr112', 'Gpr114', \"Gpr126\", \"Gpr128\", 'Lphn3'))\n```\n\n::: {.cell-output-display}\n![](quarto_files/figure-html/unnamed-chunk-12-1.png){width=864}\n:::\n:::\n\n\nWe'll include those with >0.5 relative expression levels (arbitrary) in LEC clusters: Gpr113, Gpr97, Gpr126, Lphn3. \n\nAfter narrowing down the list, we can now visualize expression levels of these ADGRs in different conditions. \n\n\n::: {.cell hash='quarto_cache/html/unnamed-chunk-13_abcf2fe4fc0db35154bdc6d3e8f5e0e1'}\n\n```{.r .cell-code}\nload(\"../data/GSE120064_TAC CM_NMCC_mtx_cell_info/clean/TAC_LEC_metadata.rdata\")\n\nDotPlot(TAC_LEC,\n        features = c(\"Emr1\",  \"Cd97\",\n                     \"Gpr113\",  \"Gpr116\",\n                     \"Gpr56\", \"Gpr97\",  'Gpr126', \n                     'Lphn1', 'Lphn2', 'Lphn3', \"Eltd1\"),\n        col.min = 0, col.max = 3,\n        dot.min = 0, dot.scale = 6)+\n  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust=1))\n```\n\n::: {.cell-output-display}\n![](quarto_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n::: {.cell hash='quarto_cache/html/unnamed-chunk-14_b87fcd5f1bc43b0078bffb404088123d'}\n\n```{.r .cell-code}\nVlnPlot(TAC_LEC, \n        features = c(\"Emr1\",  \"Cd97\",\n                     \"Gpr113\",  \"Gpr116\",\n                     \"Gpr56\", \"Gpr97\",  'Gpr126', \n                     'Lphn1', 'Lphn2', 'Lphn3', \"Eltd1\"),\n        pt.size=0.1)\n```\n\n::: {.cell-output-display}\n![](quarto_files/figure-html/unnamed-chunk-14-1.png){width=768}\n:::\n:::\n\n\nLastly, we'll look at individual LEC cluster to explore possible pattern.\n\n\n::: {.cell hash='quarto_cache/html/unnamed-chunk-15_5065729af248b1c9c6aa1a1179947ce9'}\n\n```{.r .cell-code}\nmetadata_lec <- TAC_LEC@meta.data\n\nIdents(TAC_LEC) <- metadata_lec$SubCluster\n\nVlnPlot(TAC_LEC,\n        features = c(\"Emr1\",  \"Cd97\",\n                     \"Gpr113\",  \"Gpr116\",\n                     \"Gpr56\", \"Gpr97\",  'Gpr126', \n                     'Lphn1', 'Lphn2', 'Lphn3', \"Eltd1\"),\n        idents = \"EC2\",\n        group.by = \"condition\")\n```\n\n::: {.cell-output-display}\n![](quarto_files/figure-html/unnamed-chunk-15-1.png){width=768}\n:::\n:::\n\n::: {.cell hash='quarto_cache/html/unnamed-chunk-16_fd2890eb9aea90b5b96305cceb8ae32e'}\n\n```{.r .cell-code}\nVlnPlot(TAC_LEC,\n        features = c(\"Emr1\",  \"Cd97\",\n                     \"Gpr113\",  \"Gpr116\",\n                     \"Gpr56\", \"Gpr97\",  'Gpr126', \n                     'Lphn1', 'Lphn2', 'Lphn3', \"Eltd1\"),\n        idents = \"EC3\",\n        group.by = \"condition\")\n```\n\n::: {.cell-output-display}\n![](quarto_files/figure-html/unnamed-chunk-16-1.png){width=768}\n:::\n:::\n\n\nInterestingly, both EC2 and EC3 show detectable expression only at baseline (0w) for the ADGRs examined, while EC8 cells express several ADGRs in all 5 different conditions.\n\n\n::: {.cell hash='quarto_cache/html/unnamed-chunk-17_b8ad966d1633d5dedf9cb60990a6499f'}\n\n```{.r .cell-code}\nload(\"../data/GSE120064_TAC CM_NMCC_mtx_cell_info/clean/TAC_LEC_cluster8_condition.rdata\")\n\nVlnPlot(TAC_LEC8,\n        features = c(\"Emr1\",  \"Cd97\",\n                     \"Gpr113\",  \"Gpr116\",\n                     \"Gpr56\", \"Gpr97\",  'Gpr126', \n                     'Lphn1', 'Lphn2', 'Lphn3', \"Eltd1\"))\n```\n\n::: {.cell-output-display}\n![](quarto_files/figure-html/unnamed-chunk-17-1.png){width=768}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}